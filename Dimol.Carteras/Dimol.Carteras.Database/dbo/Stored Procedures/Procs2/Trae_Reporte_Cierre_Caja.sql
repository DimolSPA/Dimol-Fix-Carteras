create Procedure Trae_Reporte_Cierre_Caja(@ddi_codemp integer, @desde datetime, @hasta datetime, @idi_idid integer) as  SELECT view_documentos_diarios.ddi_anio,              view_documentos_diarios.ddi_tipmov,              view_documentos_diarios.pcl_rut,              view_documentos_diarios.pcl_nomfant,              view_documentos_diarios.ctc_rut,              view_documentos_diarios.ctc_nomfant,              view_documentos_diarios.epl_rut,              view_documentos_diarios.epl_nombre,              view_documentos_diarios.epl_apepat,              view_documentos_diarios.tci_nombre,              view_documentos_diarios.ddi_fecing,              view_documentos_diarios.ddi_fecvenc,              view_documentos_diarios.ddi_tipcambio,              view_documentos_diarios.ddi_monto,              view_documentos_diarios.ddi_depositar,              view_documentos_diarios.bco_nombre,              estados_documentos_diarios_idiomas.edi_nombre,              estados_documentos_diarios.edc_estado,              view_documentos_diarios.ddi_pagdir,              view_documentos_diarios.ddi_custodia,           ddi_numcta        FROM view_documentos_diarios,              estados_documentos_diarios,              estados_documentos_diarios_idiomas,              view_tipos_cpbtdoc_clasificacion,              idiomas       WHERE ( view_documentos_diarios.ddi_codemp = estados_documentos_diarios.edc_codemp ) and             ( view_documentos_diarios.ddi_edcid = estados_documentos_diarios.edc_edcid ) and             ( estados_documentos_diarios_idiomas.edi_codemp = estados_documentos_diarios.edc_codemp ) and             ( estados_documentos_diarios_idiomas.edi_edcid = estados_documentos_diarios.edc_edcid ) and             ( view_documentos_diarios.ddi_codemp = view_tipos_cpbtdoc_clasificacion.tpc_codemp ) and             ( view_documentos_diarios.ddi_tpcid = view_tipos_cpbtdoc_clasificacion.tpc_tpcid ) and             ( idiomas.idi_idid = estados_documentos_diarios_idiomas.edi_idiid ) and             ( view_documentos_diarios.edi_idiid = idiomas.idi_idid ) and             ( view_documentos_diarios.tci_idid = idiomas.idi_idid ) and             ( ( view_documentos_diarios.ddi_codemp = @ddi_codemp ) AND             ( view_documentos_diarios.ddi_fecing >= @desde and ddi_fecing <= @hasta) AND             ( view_documentos_diarios.ddi_tipmov = 'I' ) AND             ( view_tipos_cpbtdoc_clasificacion.clb_aplica = 'S'  and idi_idid = @idi_idid )              )       union    SELECT view_documentos_diarios.ddi_anio,              view_documentos_diarios.ddi_tipmov,              view_documentos_diarios.pcl_rut,              view_documentos_diarios.pcl_nomfant,              view_documentos_diarios.ctc_rut,              view_documentos_diarios.ctc_nomfant,              view_documentos_diarios.epl_rut,              view_documentos_diarios.epl_nombre,              view_documentos_diarios.epl_apepat,              view_documentos_diarios.tci_nombre,              view_documentos_diarios.ddi_fecing,              view_documentos_diarios.ddi_fecvenc,              view_documentos_diarios.ddi_tipcambio,              view_documentos_diarios.ddi_monto,              view_documentos_diarios.ddi_depositar,              view_documentos_diarios.bco_nombre,              estados_documentos_diarios_idiomas.edi_nombre,              estados_documentos_diarios.edc_estado,              view_documentos_diarios.ddi_pagdir,              view_documentos_diarios.ddi_custodia,           ddi_numcta        FROM view_documentos_diarios,              estados_documentos_diarios,              estados_documentos_diarios_idiomas,              view_tipos_cpbtdoc_clasificacion,              idiomas       WHERE ( view_documentos_diarios.ddi_codemp = estados_documentos_diarios.edc_codemp ) and             ( view_documentos_diarios.ddi_edcid = estados_documentos_diarios.edc_edcid ) and             ( estados_documentos_diarios_idiomas.edi_codemp = estados_documentos_diarios.edc_codemp ) and             ( estados_documentos_diarios_idiomas.edi_edcid = estados_documentos_diarios.edc_edcid ) and             ( view_documentos_diarios.ddi_codemp = view_tipos_cpbtdoc_clasificacion.tpc_codemp ) and             ( view_documentos_diarios.ddi_tpcid = view_tipos_cpbtdoc_clasificacion.tpc_tpcid ) and             ( idiomas.idi_idid = estados_documentos_diarios_idiomas.edi_idiid ) and             ( view_documentos_diarios.edi_idiid = idiomas.idi_idid ) and             ( view_documentos_diarios.tci_idid = idiomas.idi_idid ) and             ( ( view_documentos_diarios.ddi_codemp = @ddi_codemp ) AND             ( view_documentos_diarios.ddi_fecing >= @desde and ddi_fecing <= @hasta ) AND             ( view_documentos_diarios.ddi_tipmov = 'E' and idi_idid = @idi_idid )               )     ORDER BY  view_documentos_diarios.pcl_nomfant,  ddi_fecvenc ASC 