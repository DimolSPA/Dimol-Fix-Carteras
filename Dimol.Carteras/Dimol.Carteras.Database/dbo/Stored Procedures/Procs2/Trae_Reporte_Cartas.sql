create Procedure Trae_Reporte_Cartas(@ccb_codemp integer, @ceh_estid integer, @ceh_fecha datetime, @ccb_pclid integer) as    SELECT cartera_clientes_documentos_cpbt_doc.pcl_rut,              cartera_clientes_documentos_cpbt_doc.pcl_nombre,              cartera_clientes_documentos_cpbt_doc.ctc_numero,              cartera_clientes_documentos_cpbt_doc.ctc_digito,              cartera_clientes_documentos_cpbt_doc.ctc_nomfant,              cartera_clientes_documentos_cpbt_doc.tci_nombre,              cartera_clientes_documentos_cpbt_doc.ccb_numero,              cartera_clientes_documentos_cpbt_doc.ccb_fecvenc,              cartera_clientes_documentos_cpbt_doc.ccb_saldo,              cartera_clientes_documentos_cpbt_doc.mon_nombre,              gestor.ges_nombre,              gestor.ges_telefono,              gestor.ges_email,              cartera_clientes_estados_historial.ceh_estid,              cartera_clientes_estados_historial.ceh_fecha,           pai_nombre,           reg_nombre,  	    ciu_nombre,             com_nombre,           com_codpost,           ctc_direccion      FROM cartera_clientes_documentos_cpbt_doc,              gestor,              gestor_cartera,              cartera_clientes_estados_historial,              view_datos_geograficos       WHERE ( gestor_cartera.gsc_codemp = gestor.ges_codemp ) and             ( gestor_cartera.gsc_sucid = gestor.ges_sucid ) and             ( gestor_cartera.gsc_gesid = gestor.ges_gesid ) and             ( cartera_clientes_documentos_cpbt_doc.ccb_codemp = gestor_cartera.gsc_codemp ) and             ( cartera_clientes_documentos_cpbt_doc.ccb_pclid = gestor_cartera.gsc_pclid ) and             ( cartera_clientes_documentos_cpbt_doc.ccb_ctcid = gestor_cartera.gsc_ctcid ) and             ( cartera_clientes_documentos_cpbt_doc.ccb_codemp = cartera_clientes_estados_historial.ceh_codemp ) and             ( cartera_clientes_documentos_cpbt_doc.ccb_pclid = cartera_clientes_estados_historial.ceh_pclid ) and             ( cartera_clientes_documentos_cpbt_doc.ccb_ctcid = cartera_clientes_estados_historial.ceh_ctcid ) and             ( cartera_clientes_documentos_cpbt_doc.ccb_ccbid = cartera_clientes_estados_historial.ceh_ccbid ) and             ( cartera_clientes_documentos_cpbt_doc.ctc_comid = view_datos_geograficos.com_comid ) and             ( ( cartera_clientes_documentos_cpbt_doc.ccb_codemp = @ccb_codemp and ccb_pclid = @ccb_pclid  ) AND             ( cartera_clientes_estados_historial.ceh_estid = @ceh_estid ) AND             ( datepart(year,cartera_clientes_estados_historial.ceh_fecha) = datepart(year, ceh_fecha) ) AND             ( datepart(month,cartera_clientes_estados_historial.ceh_fecha) = datepart(month, ceh_fecha) ) AND             ( datepart(day,cartera_clientes_estados_historial.ceh_fecha) =datepart(day, ceh_fecha) )                )    