create Procedure Trae_Reporte_Recuperacion_x_Producto(@cbc_codemp integer, @desde datetime, @hasta datetime) as   SELECT view_cabecera_comprobantes.pcl_rut,              view_cabecera_comprobantes.pcl_nomfant,              view_cabecera_comprobantes.cbc_feccpbt,              productos.pdt_codfisico,              productos.pdt_nombre,              view_cabecera_comprobantes.cbc_tipcambio,              detalle_comprobantes.dcc_neto,              clasificacion_cpbtdoc_contable.cct_debhab,              view_cabecera_comprobantes.tci_nombre,              view_cabecera_comprobantes.cbc_numero,              view_cabecera_comprobantes.cbc_numprovcli,              detalle_comprobantes.dcc_comentario,              view_cabecera_comprobantes.cbt_estado,              datepart(year, cbc_feccpbt) as anio,              datepart(month, cbc_feccpbt) as mes        FROM view_tipos_cpbtdoc_clasificacion,              clasificacion_cpbtdoc,              detalle_comprobantes,              productos,              view_cabecera_comprobantes,              clasificacion_cpbtdoc_contable       WHERE ( view_tipos_cpbtdoc_clasificacion.clb_clbid = clasificacion_cpbtdoc.clb_clbid ) and             ( view_tipos_cpbtdoc_clasificacion.tpc_codemp = clasificacion_cpbtdoc.clb_codemp ) and             ( productos.pdt_codemp = detalle_comprobantes.dcc_codemp ) and             ( productos.pdt_prodid = detalle_comprobantes.dcc_prodid ) and             ( view_cabecera_comprobantes.cbc_codemp = view_tipos_cpbtdoc_clasificacion.tpc_codemp ) and             ( view_cabecera_comprobantes.cbc_tpcid = view_tipos_cpbtdoc_clasificacion.tpc_tpcid ) and             ( clasificacion_cpbtdoc_contable.cct_codemp = clasificacion_cpbtdoc.clb_codemp ) and             ( clasificacion_cpbtdoc_contable.cct_clbid = clasificacion_cpbtdoc.clb_clbid ) and             ( view_cabecera_comprobantes.cbc_codemp = detalle_comprobantes.dcc_codemp ) and             ( view_cabecera_comprobantes.cbc_sucid = detalle_comprobantes.dcc_sucid ) and             ( view_cabecera_comprobantes.cbc_tpcid = detalle_comprobantes.dcc_tpcid ) and             ( view_cabecera_comprobantes.cbc_numero = detalle_comprobantes.dcc_numero ) and             ( ( view_cabecera_comprobantes.cbc_codemp = @cbc_codemp ) AND             ( view_cabecera_comprobantes.cbc_feccpbt >= @desde ) AND             ( view_cabecera_comprobantes.cbc_feccpbt <= @hasta ) AND             ( view_tipos_cpbtdoc_clasificacion.clb_contable = 'S' ) AND             ( view_tipos_cpbtdoc_clasificacion.clb_tipcpbtdoc = 'V' ) AND             ( view_cabecera_comprobantes.cbt_estado in ( 'A','B','F' ) ) )    